
@model IEnumerable<CARS.Models.Servicio>

@{
    ViewBag.Title = "ReporteServiciosNueva";
}

<h2>Reporte Servicios</h2>

<body>
    @using (Html.BeginForm("ReporteServicios", "ExportExcel", FormMethod.Post))
    {
        <fieldset>
            <p>
                <label for="fechaInicio">Desde </label>
                @if (@ViewBag.FechaInicio != "")
                {
                    <input type="date" class="form-control" value=@ViewBag.FechaInicio id="fechaInicio" name="fechaInicio">
                }
                else
                {
                    <input type="date" class="form-control" id="fechaInicio" name="fechaInicio">
                }

                <label for="fechaFin">Hasta </label>

                @if (@ViewBag.FechaFin != "")
                {
                    <input type="date" class="form-control" value=@ViewBag.FechaFin id="fechaFin" name="fechaFin">
                }
                else
                {
            <input type="date" class="form-control" id="fechaFin" name="fechaFin">
                }
                

                <input type="submit" class="btn btn-primary" id="btnFiltrar" name="submitButton" value="Filtrar">
                <input type="submit" class="btn btn-secondary" id="btnExportar" name="submitButton" value="Exportar">


            </p>

        </fieldset>
    }

    <h3>Servicios realizados</h3>
       
    <table class="table table-responsive table-striped table-hover">
        <tr>
            <th>
                @Html.DisplayNameFor(model => model.Tipo)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Vehiculo.Matricula)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Taller)
            </th>
           
            <th>
                @Html.DisplayNameFor(model => model.FechaEntrada)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.FechaSalida)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Estado)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Descripcion)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.NumeroOrden)
            </th>

        </tr>

        @foreach (var item in Model)
        {
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.Tipo)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Vehiculo.Matricula)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Taller.Nombre)
        </td>
     
        <td>
            @Html.DisplayFor(modelItem => item.FechaEntrada)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.FechaSalida)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Estado)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Descripcion)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.NumeroOrden)
        </td>

    </tr>
        }

    </table>
</body>
